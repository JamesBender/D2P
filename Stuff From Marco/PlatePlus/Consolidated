SELECT BdmEEID, BdmCOID, BdmRecType, BdmDepRecId 
            --Dental
            ,MAX(CASE WHEN BdmDedCode IN ('DENB', 'DENC', 'DENA', 'DEN') THEN BdmDedCode END) AS Dental_Code
            ,MAX(CASE WHEN BdmDedCode IN ('DENB', 'DENC', 'DENA', 'DEN') THEN BdmBenOption END) AS Dental_BdmBenOption
            ,MAX(CASE WHEN BdmDedCode IN ('DENB', 'DENC', 'DENA', 'DEN') THEN BdmBenStartDate END) AS Dental_BdmBenStartDate
            ,MAX(CASE WHEN BdmDedCode IN ('DENB', 'DENC', 'DENA', 'DEN') THEN BdmBenStopDate END) AS Dental_BdmBenStopDate
            ,MAX(CASE WHEN BdmDedCode IN ('DENB', 'DENC', 'DENA', 'DEN') THEN BdmBenStatus END) AS Dental_BdmBenStatus
            --Basic Life
            ,MAX(CASE WHEN BdmDedCode IN ('BLFAD') THEN BdmDedCode END) AS BasicLife_Code
            ,MAX(CASE WHEN BdmDedCode IN ('BLFAD') THEN BdmBenOption END) AS BasicLife_BdmBenOption
            ,MAX(CASE WHEN BdmDedCode IN ('BLFAD') THEN BdmBenStartDate END) AS BasicLife_BdmBenStartDate
            ,MAX(CASE WHEN BdmDedCode IN ('BLFAD') THEN BdmBenStopDate END) AS BasicLife_BdmBenStopDate
            ,MAX(CASE WHEN BdmDedCode IN ('BLFAD')THEN BdmBenStatus END) AS BasicLife_BdmBenStatus
              --Long Term Disability
            ,MAX(CASE WHEN BdmDedCode IN ('LTD', 'LTDX') THEN BdmDedCode END) AS LongTermDisability_Code
            ,MAX(CASE WHEN BdmDedCode IN ('LTD', 'LTDX')  THEN BdmBenOption END) AS LongTermDisability_BdmBenOption
            ,MAX(CASE WHEN BdmDedCode IN ('LTD', 'LTDX')  THEN BdmBenStartDate END) AS LongTermDisability_BdmBenStartDate
            ,MAX(CASE WHEN BdmDedCode IN ('LTD', 'LTDX') THEN BdmBenStopDate END) AS LongTermDisability_BdmBenStopDate
            ,MAX(CASE WHEN BdmDedCode IN ('LTD', 'LTDX') THEN BdmBenStatus END) AS LongTermDisability_BdmBenStatus
             --Short Term Disability
            ,MAX(CASE WHEN BdmDedCode IN ('STD') THEN BdmDedCode END) AS ShortTermDisability_Code
            ,MAX(CASE WHEN BdmDedCode IN ('STD')  THEN BdmBenOption END) AS ShortTermDisability_BdmBenOption
            ,MAX(CASE WHEN BdmDedCode IN ('STD')  THEN BdmBenStartDate END) AS ShortTermDisability_BdmBenStartDate
            ,MAX(CASE WHEN BdmDedCode IN ('STD') THEN BdmBenStopDate END) AS ShortTermDisability_BdmBenStopDate
            ,MAX(CASE WHEN BdmDedCode IN ('STD') THEN BdmBenStatus END) AS ShortTermDisability_BdmBenStatus

             --Supplimental Basic Life
            ,MAX(CASE WHEN BdmDedCode IN ('LIFEE') THEN BdmDedCode END) AS SupBasicLife_Code
            ,MAX(CASE WHEN BdmDedCode IN ('LIFEE')  THEN BdmBenOption END) AS SupBasicLife_BdmBenOption
            ,MAX(CASE WHEN BdmDedCode IN ('LIFEE')  THEN BdmBenStartDate END) AS SupBasicLife_BdmBenStartDate
            ,MAX(CASE WHEN BdmDedCode IN ('LIFEE') THEN BdmBenStopDate END) AS SupBasicLife_BdmBenStopDate
            ,MAX(CASE WHEN BdmDedCode IN ('LIFEE') THEN BdmBenStatus END) AS SupBasicLife_BdmBenStatus
            
             --Supplimental Spouse Life
            ,MAX(CASE WHEN BdmDedCode IN ('LIFES') THEN BdmDedCode END) AS SupSpouseLife_Code
            ,MAX(CASE WHEN BdmDedCode IN ('LIFES')  THEN BdmBenOption END) AS SupSpouseLife_BdmBenOption
            ,MAX(CASE WHEN BdmDedCode IN ('LIFES')  THEN BdmBenStartDate END) AS SupSpouseLife_BdmBenStartDate
            ,MAX(CASE WHEN BdmDedCode IN ('LIFES') THEN BdmBenStopDate END) AS SupSpouseLife_BdmBenStopDate
            ,MAX(CASE WHEN BdmDedCode IN ('LIFEE') THEN BdmBenStatus END) AS SupSpouseLife_BdmBenStatus
            
              --Supplimental Children Life
            ,MAX(CASE WHEN BdmDedCode IN ('LIFEC') THEN BdmDedCode END) AS SupChildrenLife_Code
            ,MAX(CASE WHEN BdmDedCode IN ('LIFEC')  THEN BdmBenOption END) AS SupChildrenLife_BdmBenOption
            ,MAX(CASE WHEN BdmDedCode IN ('LIFEC')  THEN BdmBenStartDate END) AS SupChildrenLife_BdmBenStartDate
            ,MAX(CASE WHEN BdmDedCode IN ('LIFEC') THEN BdmBenStopDate END) AS SupChildrenLife_BdmBenStopDate
            ,MAX(CASE WHEN BdmDedCode IN ('LIFEC') THEN BdmBenStatus END) AS SupChildrenLife_BdmBenStatus

            --Supplimental Basic AD&D
            ,MAX(CASE WHEN BdmDedCode IN ('ADDE') THEN BdmDedCode END) AS SupBasicADD_Code
            ,MAX(CASE WHEN BdmDedCode IN ('ADDE')  THEN BdmBenOption END) AS SupBasicADD_BdmBenOption
            ,MAX(CASE WHEN BdmDedCode IN ('ADDE')  THEN BdmBenStartDate END) AS SupBasicADD_BdmBenStartDate
            ,MAX(CASE WHEN BdmDedCode IN ('ADDE') THEN BdmBenStopDate END) AS SupBasicADD_BdmBenStopDate
            ,MAX(CASE WHEN BdmDedCode IN ('ADDE') THEN BdmBenStatus END) AS SupBasicADD_BdmBenStatus

              --Supplimental Spouse AD&D
            ,MAX(CASE WHEN BdmDedCode IN ('ADDS') THEN BdmDedCode END) AS SupSpouseADD_Code
            ,MAX(CASE WHEN BdmDedCode IN ('ADDS')  THEN BdmBenOption END) AS SupSpouseADD_BdmBenOption
            ,MAX(CASE WHEN BdmDedCode IN ('ADDS')  THEN BdmBenStartDate END) AS SupSpouseADD_BdmBenStartDate
            ,MAX(CASE WHEN BdmDedCode IN ('ADDS') THEN BdmBenStopDate END) AS SupSpouseADD_BdmBenStopDate
            ,MAX(CASE WHEN BdmDedCode IN ('ADDS') THEN BdmBenStatus END) AS SupSpouseADD_BdmBenStatus
            
                    --Supplimental Child AD&D
            ,MAX(CASE WHEN BdmDedCode IN ('ADDC') THEN BdmDedCode END) AS SupChildADD_Code
            ,MAX(CASE WHEN BdmDedCode IN ('ADDC')  THEN BdmBenOption END) AS SupChildADD_BdmBenOption
            ,MAX(CASE WHEN BdmDedCode IN ('ADDC')  THEN BdmBenStartDate END) AS SupChildADD_BdmBenStartDate
            ,MAX(CASE WHEN BdmDedCode IN ('ADDC') THEN BdmBenStopDate END) AS SupChildADD_BdmBenStopDate
            ,MAX(CASE WHEN BdmDedCode IN ('ADDC') THEN BdmBenStatus END) AS SupChildADD_BdmBenStatus
            
              --Critical Illness
            ,MAX(CASE WHEN BdmDedCode IN ('CRE10', 'CRE20', 'CRFM1', 'CRFM2', 'CRCH1', 'CRCH5', 'CRS10', 'CRS5') THEN BdmDedCode END) AS CritIllness_Code
            ,MAX(CASE WHEN BdmDedCode IN ('CRE10', 'CRE20', 'CRFM1', 'CRFM2', 'CRCH1', 'CRCH5', 'CRS10', 'CRS5')  THEN BdmBenOption END) AS CritIllness_BdmBenOption
            ,MAX(CASE WHEN BdmDedCode IN ('CRE10', 'CRE20', 'CRFM1', 'CRFM2', 'CRCH1', 'CRCH5', 'CRS10', 'CRS5') THEN BdmBenStartDate END) AS CritIllness_BdmBenStartDate
            ,MAX(CASE WHEN BdmDedCode IN ('CRE10', 'CRE20', 'CRFM1', 'CRFM2', 'CRCH1', 'CRCH5', 'CRS10', 'CRS5')THEN BdmBenStopDate END) AS CritIllness_BdmBenStopDate
            ,MAX(CASE WHEN BdmDedCode IN ('CRE10', 'CRE20', 'CRFM1', 'CRFM2', 'CRCH1', 'CRCH5', 'CRS10', 'CRS5') THEN BdmBenStatus END) AS SupChildADD_BdmBenStatus

                --Critical Illness Dependent
            ,MAX(CASE WHEN BdmDedCode IN ('CRCH1', 'CRCH5', 'CRS10', 'CRS5', 'CRFM1', 'CRFM2') THEN BdmDedCode END) AS CritIllnessDep_Code
            ,MAX(CASE WHEN BdmDedCode IN ('CRCH1', 'CRCH5', 'CRS10', 'CRS5', 'CRFM1', 'CRFM2')  THEN BdmBenOption END) AS CritIllnessDep_BdmBenOption
            ,MAX(CASE WHEN BdmDedCode IN ('CRCH1', 'CRCH5', 'CRS10', 'CRS5', 'CRFM1', 'CRFM2')THEN BdmBenStartDate END) AS CritIllnessDep_BdmBenStartDate
            ,MAX(CASE WHEN BdmDedCode IN ('CRCH1', 'CRCH5', 'CRS10', 'CRS5', 'CRFM1', 'CRFM2')THEN BdmBenStopDate END) AS CritIllnessDep_BdmBenStopDate
            ,MAX(CASE WHEN BdmDedCode IN ('CRCH1', 'CRCH5', 'CRS10', 'CRS5', 'CRFM1', 'CRFM2') THEN BdmBenStatus END) AS CritIllnessDep_BdmBenStatus

               --Group Accident
            ,MAX(CASE WHEN BdmDedCode IN ('ACCH', 'ACCL') THEN BdmDedCode END) AS GroupAccident_Code
            ,MAX(CASE WHEN BdmDedCode IN ('ACCH', 'ACCL') THEN BdmBenOption END) AS GroupAccident_BdmBenOption
            ,MAX(CASE WHEN BdmDedCode IN ('ACCH', 'ACCL') THEN BdmBenStartDate END) AS GroupAccident_BdmBenStartDate
            ,MAX(CASE WHEN BdmDedCode IN ('ACCH', 'ACCL') THEN BdmBenStopDate END) AS GroupAccident_BdmBenStopDate
            ,MAX(CASE WHEN BdmDedCode IN ('ACCH', 'ACCL') THEN BdmBenStatus END) AS GroupAccident_BdmBenStatus


               --Hospital Indemnity
            ,MAX(CASE WHEN BdmDedCode IN ('HOSPH', 'HOSPL') THEN BdmDedCode END) AS HospIndemity_Code
            ,MAX(CASE WHEN BdmDedCode IN ('HOSPH', 'HOSPL') THEN BdmBenOption END) AS HospIndemity_BdmBenOption
            ,MAX(CASE WHEN BdmDedCode IN ('HOSPH', 'HOSPL') THEN BdmBenStartDate END) AS HospIndemity_BdmBenStartDate
            ,MAX(CASE WHEN BdmDedCode IN ('HOSPH', 'HOSPL') THEN BdmBenStopDate END) AS HospIndemity_BdmBenStopDate
            ,MAX(CASE WHEN BdmDedCode IN ('HOSPH', 'HOSPL')THEN BdmBenStatus END) AS HospIndemity_BdmBenStatus
            
            FROM dbo.U_dsi_BDM_EMETPLALIF WITH (NOLOCK)
            GROUP BY BdmEEID, BdmCOID, BdmRecType, BdmDepRecId
        ) AS Bdm_Flattened
        ON BdmEEID = xEEID 
        AND BdmCOID = xCOID